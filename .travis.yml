os:
  - linux

sudo: false

dist: trusty

addons:
  apt:
    packages:
      - lcov
      - build-essential
      - git
      - libc6-i386
      - time
      - libblocksruntime-dev

git:
  depth: 5

# We use cpp for unit tests, and c for the main project.
language: cpp
compiler: clang

env:
#  - PUBLISHMETA=True
#  - PUBLISHDOCS=True
# Specify the main Mafile supported goals.
  - GOAL=test
  - GOAL=targets-group-1
  - GOAL=targets-group-2
  - GOAL=targets-group-3
  - GOAL=targets-group-4
  - GOAL=targets-group-rest
#  - GOAL=all
#  - GOAL=AFROMINI
#  - GOAL=AIORACERF3
#  - GOAL=...
# Or specify targets to run.
#  - TARGET=AFROMINI
#  - TARGET=AIORACERF3
#  - TARGET=...

before_install:
  - pip install --user cpp-coveralls
  - gem install coveralls-lcov

install:
  - make arm_sdk_install

before_script:
  - make arm_sdk_version
  - clang --version
  - clang++ --version
  - gcc --version
  - export V=0

script: ./.travis.sh

cache:
  timeout: 1000
  directories:
  - downloads
  - tools

# Notifications are encrypted to betaflight/betaflight to avoid spam from forks
notifications:
  slack:
    rooms:
      - secure: q7hAJJtB2RHwM+Ru08trGSqadDi1u/4ZybTFS3T+TgrxTLGaTpHDNFtID9CMo9Y7tFJvQno0+H5WSryufS6qFFSaBjnZY89u6CKFZSQWvb5CS0qJOz+XOvuIO52EZD6GADGqiUQAibXs9QTKUHX+EQvwedKOSCYDkZ/QMX2QOKdYDlDxqqonSsPdUglDE3edVzbVPjpbVVJqHYfdOmO6DdPIADXFeQjSWqNXwwHUgjVeLl3oWwzOmUHbVO/MMaCfk3W6XBceDbKwHIQfSd+VhsVAzE0HcDCkhALJ0y5zpfREVHnpG8rIbe9rgvILzZD55YbPR7uHz8CNEXhUTUmjlRuZD06OHWtZf58qfqyYJluHbI/n+Q6e14UKdRMYMnvncsoCjgIT557fTjktGGfS6riyaLckEijmms4NY49FC5Yib1537PDW3KaAJlz+tFkZuIGTThzJAAf6J6B1FAY5rxnslrH16i9bzugIJsYn/kYcWcxhZy7w+VgUrg5MJNc6c7OOfAMWRiEfIKWMaD2wqpxWKy3aptj+KNxj+5fo6yJBRQzG5XtfuVns74EVwMvXP2/G52Vs/y2kYa3IJP3+63biiLUHvQa2BUefl8LicCYlLVybDF7rJu8bsXdnOFMG3OSSPjKyiUzeNMXbKhGDgW2UX/+9bnTtZtk0t+9dp+s=
  webhooks:
    urls:
      - secure: DXXka6VNPgpDOKnWrnj+xRqw9IVFx/VcPZ/uJcNUp9yqb0wXqRct3pd/8pQdgVgyeDqstd1CpJ4I0wn06MmNV24uZQZQMvjl4i0Hv4xoJdFhTN6agnl8991lFtq9XnNNKvD7m3ZHgIKfZ+QqEbjRLt28QaG+N0LYzmGy0pui0gUPSkpXA1yY+g89hJuijnpAIAvyQikmvlnfF3dfZbpKy2dIrHP6P2zC3cQBR/uv6HCMYicTt3E147py86I2ILaEQGICKaOJj9dxlE88mDS39Q0qd/ODpfasgD2iApVBKJStFNgStlf6FNt6no83ZBUfK58vFOJvMIJAooOKgvvfViPT9k5yxmQmxU8rpFTUgVQmF4eb/WnobYDA7dIS06vxIJIDrQGNqilkp20tQXqT3CUjcX3ReJ6TvBSS/29hZBxsikFDyY2w8HTFFJFu8yXte28/kLGaj81G4AN7YTf9Lshc+B8gRZs0vvtXwWqBa0rmnoj+d3wepJ/PlXSGEW04vVf96qZdaAkHTDZsi2brIA9F78a7f13ZSEGHT69Iod1nHtkdTzq7+YVvCWLKMuNaxZos79bx7ru4bnoS3arADgNm7a9ETcVGu1lINM888cmf1pIHG/W7L8VBmnIZytYeZJBLC9G91enzbzf0Yl08q2I7OCqUmEGNqTqJOB8mgAo=
    on_success: always  # options: [always|never|change] default: always
    on_failure: always  # options: [always|never|change] default: always
    on_start: always     # options: [always|never|change] default: always
